<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Resumen del Pedido</title>
    <style>
      body {
        font-family: "Arial", sans-serif;
        margin: 25px;
        color: #333;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        border-bottom: 2px solid #007bff;
        padding-bottom: 6px;
      }

      .empresa-info {
        display: flex;
        gap: 15px;
      }

      .empresa-info img {
        height: 50px;
        object-fit: contain;
      }

      .empresa-datos h2 {
        margin: 0;
        color: #007bff;
        font-size: 16px; /* Discreto */
      }

      .empresa-datos p {
        margin: 1px 0;
        font-size: 11px;
      }

      .datos-pedido p {
        margin: 2px 0;
        font-size: 10px;
      }

      .section {
        margin-top: 16px;
      }

      .section h3 {
        color: #007bff;
        border-bottom: 1px solid #007bff;
        padding-bottom: 3px;
        margin-bottom: 8px;
        font-size: 13px;
      }

      /* ===== Solo compactamos datos de cliente/contacto ===== */
      .info-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 4px 16px;             /* Menos espacio */
        margin-top: 10px;          /* Más compacto */
      }
      .info-grid p {
        margin: 1px 0;             /* Casi sin margen */
        font-size: 9.5px;          /* Más pequeño SOLO aquí */
        line-height: 1.2;          /* Línea compacta */
      }
      .info-grid strong {
        font-weight: 600;
      }

      /* ===== Tabla de productos más cómoda ===== */
      table {
        width: 100%;
        border-collapse: collapse;
        font-size: 11px;           /* Legible */
      }
      th {
        background-color: #007bff;
        color: white;
        padding: 8px;              /* Un poco más de aire */
        text-align: left;
      }
      td {
        padding: 6px;              /* Un poco más de aire */
        border-bottom: 1px solid #ddd;
      }

     .observaciones { 
    margin-top: 12px; 
    font-size: 10px; 
    background-color: #f9f9f9; 
    border: 1px solid #ddd; 
    padding: 8px; 
    border-radius: 4px; 
  }
  .observaciones h4 {
    margin: 0 0 4px 0;
    font-size: 11px;
    color: #007bff;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  .observaciones h5 {
    margin: 6px 0 6px 0;
    font-size: 10.5px;
    color: #333;
    font-weight: 600;
  }
  .obs-body {
    white-space: pre-line; /* <-- respeta \n y \r\n */
    line-height: 1.35;
  }

      .resumen {
        margin-top: 14px;
        text-align: right;
        font-size: 12px;
        font-weight: bold;
      }

      .footer {
        margin-top: 20px;
        font-size: 11px;
        text-align: center;
        color: #555;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <div class="empresa-info">
        <img src="<%= logoUrl %>" alt="Logo Empresa" />
        <div class="empresa-datos">
          <h2><%= nombreEmpresa %></h2>
          <p><%= direccionEmpresa %></p>
          <p>Tel: <%= telefonoEmpresa %></p>
        </div>
      </div>
      <div class="datos-pedido">
        <p><strong>Pedido:</strong> #<%= id.slice(0, 5).toUpperCase() %></p>
        <p><strong>Fecha:</strong> <%= new Date(fecha).toLocaleDateString("es-CO") %></p>
      </div>
    </div>

    <div class="section info-grid">
      <div>
        <p><strong>Cliente:</strong> <%= cliente %></p>
        <p><strong>NIT / C.C.:</strong> <%= nitCliente %></p>
        <p><strong>Dirección:</strong> <%= direccionCliente %></p>
        <p><strong>Ciudad:</strong> <%= ciudadCliente %></p>
        <p><strong>Departamento:</strong> <%= departamentoCliente %></p>
      </div>
      <div>
        <p><strong>Teléfono:</strong> <%= telefonoCliente %></p>
        <p><strong>Email:</strong> <%= emailCliente %></p>
        <p><strong>Vendedor:</strong> <%= vendedor %></p>
      </div>
    </div>

    <div class="section">
      <h3>Detalle del Pedido</h3>
      <table>
        <thead>
          <tr>
            <th>Ítem</th>
            <th>Producto</th>
            <th>Cantidad</th>
            <th>Precio Unitario</th>
            <th>Subtotal</th>
          </tr>
        </thead>
        <tbody>
          <% productos.forEach((producto, index) => { %>
            <tr>
              <td><%= index + 1 %></td>
              <td><%= producto.nombre %></td>
              <td><%= producto.cantidad %></td>
              <td>$<%= producto.precio.toLocaleString("es-CO") %></td>
              <td>$<%= producto.subtotal.toLocaleString("es-CO") %></td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>

    <% if (observaciones && observaciones.trim() !== "") { %>
  <div class="observaciones">
    <h4>Observaciones</h4>
    <h5>Auditoría</h5>
    <p class="obs-body"><%= observaciones %></p>
  </div>
<% } %>


    <div class="resumen">
      Total Pedido: $<%= total.toLocaleString("es-CO") %>
    </div>

    <div class="footer">
      <p><strong>Este documento ha sido generado automáticamente.</strong></p>
      <p>Gracias por su compra. Estamos atentos a cualquier duda o comentario.</p>
    </div>
  </body>
</html>
